<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html 
     PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>JDoctest: an implementation of Python doctest for Java/Javadoc</title>
  <meta name="keywords"
        content="javadoc,doctest,java" />
<base href="http://cscott.net/Projects/JDoctest/index.html" />
<link rel="icon" href="headshot.png" type="image/png">
<link rel="shortcut icon" href="http://cscott.net/favicon.ico">
<link rel="alternate" type="application/atom+xml" title="Commits to JDoctest" href="http://github.com/feeds/cscott/commits/JDoctest/master" >

</head>
<body bgcolor="white">
<a href="https://github.com/cscott/JDoctest"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://camo.githubusercontent.com/365986a132ccd6a44c23a9169022c0b5c890c387/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f7265645f6161303030302e706e67" alt="Fork me on GitHub" data-canonical-src="https://s3.amazonaws.com/github/ribbons/forkme_right_red_aa0000.png"></a>

<h1 align="center">JDoctest<br /><font size="-1">An implementation of
Python doctests for Java/Javadoc</font></h1>
<p align="center"><i>C. Scott Ananian</i></p>
<hr />

<p>
JDoctest is an implementation of Python's
<a href="http://docs.python.org/lib/module-doctest.html">doctest</a> for Java,
based on the
ideas in <a href="http://code.google.com/p/doctestj/">doctestj</a> and
<a href="http://blog.norrisboyd.com/2008/03/doctest-in-rhino.html">Rhino's
doctests</a>.</p>

<p>Unlike doctestj, JDoctest is a javadoc <a href="http://java.sun.com/j2se/1.5.0/docs/guide/javadoc/taglet/overview.html">Taglet</a>, rather than a Doclet.
It doesn't replace the standard javadoc, it just adds a new
<code>@doc.test</code> tag.  We also use a multiline format similar to
Python's doctest (based on <a
href="http://www.mozilla.org/rhino">Rhino</a>'s implementation) rather
than insist on a single evaluated expression, as doctestj does.</p>

<p>Doctest blocks are written in Javascript.  <a
href="https://developer.mozilla.org/en-US/docs/Rhino/Scripting_Java">Calling
from Javascript into Java</a> is straightforward.  An example from the top
of the <code>net.cscott.jdoctest.JDoctest</code> class:</p>

<pre>
/**
 * A "@doc.test" tag specifies an interactive javascript
 * session, in an environment where the class' package has been imported.
 * The output of the javascript session should match the output
 * provided.
 *
 * @author C. Scott Ananian
 * @doc.test
 *   This is an example of a test which passes:
 *   js&gt; "a".equals("a")
 *   true
 * @doc.test
 *   This is an example of a test which fails:
 *   js&gt; 1+2
 *   5
 * @doc.test
 *   We can write tests which expect exceptions to be thrown, although
 *   it's a little clunky (implementing doctest.ELLIPSIS or
 *   doctest.IGNORE_EXCEPTION_DETAIL would make this nicer):
 *   js&gt; try {
 *     &gt;   java.lang.String("hi").charAt(3);
 *     &gt; } catch (e) {
 *     &gt;   print(e.javaException.getMessage())
 *     &gt; }
 *   String index out of range: 3
 * @doc.test
 *   This demonstrates that the current package has been imported:
 *   js&gt; JDoctest
 *   [JavaClass net.cscott.jdoctest.JDoctest]
 *   js&gt; Version.PACKAGE_NAME
 *   jdoctest
 * @doc.test
 *   Note that results referencing object hashes are properly handled in
 *   the output comparison function, even when Rhino gives a different hash
 *   at runtime:
 *   js&gt; o = new java.lang.Object()
 *   java.lang.Object@1d2068d
 *   js&gt; o
 *   java.lang.Object@1d2068d
 *   js&gt; new java.lang.Object()
 *   java.lang.Object@1ac2f9c
 */
public class JDoctest implements Taglet { ... }
</pre>

<p><a href="http://cscott.net/Projects/JDoctest/jdoctest-latest/api/net/cscott/jdoctest/JDoctest.html">View the generated javadoc for this example</a>.</p>

<h3>Downloading</h3>
<p>JDoctest is currently at version 1.6.  You can 
<a href="jdoctest-latest/">download the latest version</a>,
see recent changes at
<a href="https://www.ohloh.net/p/jdoctest/commits">ohloh</a> or
<a href="http://github.com/cscott/JDoctest/commits/master">github</a>,
<!--see <a href="jdoctest-latest/ChangeLog.txt">recent changes</a>,-->
or browse the
<a href="http://github.com/cscott/JDoctest">source code</a> or
<a href="jdoctest-latest/api">API documentation</a> on-line.
Jdoctest is licensed under the <a href="http://www.gnu.org">GNU</a>
<a href="http://www.fsf.org/copyleft/gpl.html">GPL v2 or later</a>.
</p>

<h3>Source code repository</h3>
<p>The git repository for jdoctest can be cloned with the following command:</p>
<!-- was: http://cscott.net/Projects/git/jdoctest -->
<pre>
git-clone <a href="https://github.com/cscott/JDoctest.git">https://github.com/cscott/JDoctest.git</a>
</pre>

<h3>Building from source; installing</h3>

<p>To build:</p>
<ul>
 <li> Copy <code>sample.build.properties</code> to <code>build.properties</code> and edit it to
   properly reflect that path to your JDK.  (We need to use the <code>tools.jar</code>
   file from the JDK, so we need to know where to find it.)</li>
 <li> Run <code>ant javadoc</code>, which will build the source code and then run its
   doctests.</li>
 <li> One failure is to be expected as the tests are run; it is included
   to show the results of a failing test in the output javadoc.</li>
</ul>

<p>To install:</p>

<ul>
 <li> Move the generated <code>jdoctest-*.jar</code> as well as <code>lib/rhino*/js.jar</code> to
   a directory in your project.  If your project uses a pre-1.5 JDK,
   use <code>lib/rhino*/js-14.jar</code> instead of <code>js.jar</code>.  Below, we will assume
   that you've placed both these files in <code>lib/jdoctest</code> in your project.</li>
</ul>

<h3>Invocation</h3>
<p>To invoke from the command line:</p>
<pre>
javadoc -taglet net.cscott.jdoctest.JDoctest \
        -tagletpath lib/jdoctest/jdoctest.jar:lib/jdoctest/js.jar:bin \
        -J-ea \
        &lt;your other javadoc options go here&gt;
</pre>
<p>
I'm assuming that your source code has been compiled into <code>bin</code>.  Note
  that your compiled class files must be included on the tagletpath so that
  we can run the doctests.  Use <code>js-14.jar</code> instead of <code>js.jar</code> if your project
  uses a pre-1.5 JDK.
  Note that you need to use the <code>-J-ea</code> option if you
  want assertions to be enabled during the evaluation of the doctests.
  You can use <code>-J-ea:&lt;your package&gt;...</code> to only enable assertions in your
  code (not in the entire javadoc tool).
</p>
<p>If you are using <a href="http://ant.apache.org/">Apache Ant</a>, the
following rule will work:</p>
<pre>
  &lt;javadoc failonerror="true" ...&gt;
    &lt;taglet name="net.cscott.jdoctest.JDoctest"
            path="lib/jdoctest/jdoctest.jar:lib/jdoctest/js.jar:bin" /&gt;
    &lt;arg value="-J-ea" /&gt;
  &lt;/javadoc&gt;
</pre>

<p>As before, replace <code>bin</code> with the appropriate path to your compiled
  project classes, and use <code>js-14.jar</code> instead of <code>js.jar</code> if your project
  uses a pre-1.5 JDK.   The <code>-J-ea</code> argument ensures assertions are
  enabled in your code when doctests are evaluated.
</p>

<p>You may want to add css rules to make the output prettier.  JDoctest has
hooks to allow the use of
<a href="http://code.google.com/p/google-code-prettify/">google-code-prettify</a>
which will do syntax highlighting on the client side.  The <code>build.xml</code> file for JDoctest shows how this is hooked up.  The files in
<code>src/doc-test</code> should be copied to the top-level source directory of
your project.  Note that javadoc's directory structure for the generated
documentation makes it tedious to link to the top-level doc-files directory
from the generated documentation, but we add a <code>&lt;script&gt;</code> tag at the
bottom of each javadoc page (using the <code>-bottom</code> option) to make it all
work out.
</p>

<p>JUnit support was added in JDoctest version 1.5; see the <a href="jdoctest-latest/README.md">README file</a> included with JDoctest for more details.</p>

<h3>Mailing list</h3>

<p>Sign up to receive mail when new versions of JDoctest are
released.</p>

<table border="0" style="padding: 5px;" cellspacing="0">
  <tr><td>
    <img src="http://groups.google.com/groups/img/3/groups_bar.gif"
         height="26" width="132" alt="Google Groups" />
  </td></tr>
  <tr><td style="padding-left: 5px">
    <b>Subscribe to JDoctest Announce List</b>
  </td></tr>
  <tr><td style="padding-left: 5px;">
  <form action="http://groups.google.com/group/jdoctest-announce/boxsubscribe">
    Email: <input type="text" name="email" />
           <input type="submit" name="sub" value="Subscribe" />
</form>
  </td></tr>
<tr><td align="right">
  <a href="http://groups.google.com/group/jdoctest-announce">Visit this group</a>
</td></tr>
</table>

<p>You can also follow the project on
<a href="https://github.com/cscott/JDoctest">github</a>,
<a href="https://www.ohloh.net/p/jdoctest">ohloh</a> or
<a href="http://cananian.livejournal.com/tag/jdoctest">LiveJournal</a>.</p>

<h3>Version Archive</h3>
<p><a href="jdoctest-1.6">Jdoctest 1.6</a>, released 31-Mar-2014.</p>
<p><a href="jdoctest-1.5">Jdoctest 1.5</a>, released 12-Sep-2009.</p>
<p><a href="jdoctest-1.4">Jdoctest 1.4</a>, released 09-Mar-2009.</p>
<p><a href="jdoctest-1.3">Jdoctest 1.3</a>, released 10-Feb-2009.</p>
<p><a href="jdoctest-1.2">Jdoctest 1.2</a>, released 07-Feb-2009.</p>
<p><a href="jdoctest-1.1">Jdoctest 1.1</a>, released 05-Feb-2009.</p>
<p><a href="jdoctest-1.0">Jdoctest 1.0</a>, released 04-Feb-2009.</p>

<hr />
<div align="right">
C. Scott Ananian
<address>
  <a href="http://cscott.net">cscott<img src="../../Images/ta.png"
  border="0" alt=" " />cscott.net</a>
</address>
 <p>
<a href="http://validator.w3.org/check/referer"><img
        src="http://www.w3.org/Icons/valid-xhtml10"
        alt="Valid XHTML 1.0!" height="31" width="88" /></a>
</p>
</div>
</body>
</html>
